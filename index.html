<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Culture Quotidienne ‚Äî 10 fiches + quiz par jour</title>
  <meta name="description" content="Apprends 10 sujets de culture g√©n√©rale par jour, puis teste-toi avec un quiz. Site statique, gratuit, sans inscription." />
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --card: #111827;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #22c55e;
      --accent-2: #60a5fa;
      --warn: #f59e0b;
      --danger: #ef4444;
      --ok: #10b981;
      --border: #1f2937;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif;
      background: linear-gradient(120deg, #0b1222, #0f172a 30%, #0b1222);
      color: var(--text);
    }
    header {
      padding: 24px 16px; border-bottom: 1px solid var(--border);
      position: sticky; top: 0; background: rgba(15,23,42,0.7); backdrop-filter: blur(8px); z-index: 50;
    }
    .container { max-width: 1000px; margin: 0 auto; padding: 0 16px; }
    h1 { margin: 0; font-size: 28px; letter-spacing: 0.2px;}
    .sub { color: var(--muted); font-size: 14px; margin-top: 6px; }
    .row { display: grid; grid-template-columns: repeat(12, 1fr); gap: 16px; }
    .hero {
      margin: 20px 0 8px; padding: 16px; border: 1px solid var(--border);
      background: radial-gradient(1200px 600px at 10% -10%, rgba(96,165,250,0.08), transparent 50%),
                  radial-gradient(1000px 500px at 100% 0%, rgba(34,197,94,0.08), transparent 50%),
                  #0b1222;
      border-radius: 18px;
    }
    .hero .stats { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 10px; }
    .pill {
      font-size: 12px; color: var(--text); border: 1px solid var(--border);
      background: #0a0f1d; padding: 6px 10px; border-radius: 999px;
    }
    .actions { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 12px; }
    button, .btn {
      cursor: pointer; border: 1px solid var(--border); background: #102038; color: var(--text);
      padding: 10px 14px; border-radius: 12px; font-size: 14px; transition: 150ms ease;
    }
    button:hover, .btn:hover { transform: translateY(-1px); border-color: #2a3b5a; }
    .btn-primary { background: linear-gradient(180deg, #1d4ed8, #1e40af); border-color: #1e3a8a; }
    .btn-accent { background: linear-gradient(180deg, #059669, #047857); border-color: #065f46; }
    .grid {
      margin: 20px 0 30px; display: grid; gap: 16px; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    }
    .card {
      border: 1px solid var(--border); background: #0d1426; border-radius: 16px; padding: 14px;
      display: flex; flex-direction: column; gap: 8px; min-height: 200px;
    }
    .cat { font-size: 12px; color: var(--accent-2); text-transform: uppercase; letter-spacing: 0.6px; }
    .title { font-size: 18px; font-weight: 600; }
    .points { margin: 0; padding-left: 18px; color: var(--muted); }
    .points li { margin: 4px 0; }
    .muted { color: var(--muted); }
    .divider { height: 1px; background: var(--border); margin: 14px 0; }
    .quiz { display: none; border: 1px solid var(--border); padding: 16px; border-radius: 16px; background: #0d1426; }
    .q { margin-bottom: 18px; }
    .q h4 { margin: 0 0 10px; }
    .choices { display: grid; gap: 8px; }
    .choices label { display: flex; gap: 8px; align-items: start; cursor: pointer; }
    .score {
      display: none; margin-top: 14px; padding: 12px; border-radius: 12px; background: #0a1a12; border: 1px solid #0b3a2a;
    }
    .badge { display: inline-block; padding: 2px 8px; border-radius: 999px; font-size: 12px; border: 1px solid var(--border); }
    footer { color: var(--muted); font-size: 12px; padding: 20px 0 60px; }
    code { background: #0a0f1d; padding: 2px 6px; border-radius: 6px; border: 1px solid var(--border); }
    .small { font-size: 12px; }
    .hint { margin-top: 8px; color: var(--muted); font-size: 13px; }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>Culture Quotidienne</h1>
      <div class="sub">10 mini-fiches par jour + un quiz pour mesurer ce que tu as retenu.</div>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <div class="row">
        <div style="grid-column: span 12;">
          <div class="pill" id="dayLabel">Jour ‚Äî</div>
          <h2 id="heroTitle" style="margin: 10px 0 6px;">S√©lection du jour</h2>
          <div class="muted small">Date : <span id="today"></span> ‚Ä¢ <span class="badge" id="topicsCount">‚Äî sujets</span></div>

          <div class="actions">
            <button class="btn-primary" id="startQuiz">üéØ Commencer le quiz</button>
            <button class="btn" id="toggleContent">Afficher/masquer les fiches</button>
            <a class="btn-accent" href="#" id="shareLink">Partager le jour</a>
          </div>
          <div class="stats">
            <span class="pill">Gratuit ‚Ä¢ Statique ‚Ä¢ Open source</span>
            <span class="pill">Sans inscription</span>
          </div>
        </div>
      </div>
    </section>

    <section id="content" class="grid"></section>

    <section id="quiz" class="quiz">
      <h3>Quiz ‚Äî 10 questions (1 par fiche)</h3>
      <form id="quizForm"></form>
      <button class="btn-primary" id="submitQuiz">Valider</button>
      <div class="score" id="scoreBox"></div>
    </section>

    <footer>
      <div class="divider"></div>
      <p>üí° Pour ajouter d'autres jours, duplique <code>content/day001.json</code> en <code>content/day002.json</code>, <code>day003.json</code>, etc.
      Mets √† jour <code>meta.day</code> et le contenu. Le site charge automatiquement le fichier correspondant au num√©ro du jour.</p>
      <p class="small">Sous licence MIT. Construit pour rester gratuit (GitHub Pages ou tout h√©bergement statique).</p>
    </footer>
  </main>

  <script>
    const START_DATE = "2025-08-13";
    const AVAILABLE_DAYS = 1;
    const contentEl = document.getElementById('content');
    const quizEl = document.getElementById('quiz');
    const quizForm = document.getElementById('quizForm');
    const topicsCount = document.getElementById('topicsCount');
    const dayLabel = document.getElementById('dayLabel');
    const scoreBox = document.getElementById('scoreBox');
    const heroTitle = document.getElementById('heroTitle');
    const todaySpan = document.getElementById('today');
    const shareLink = document.getElementById('shareLink');

    function pad(n){ return String(n).padStart(3,'0'); }
    function formatDate(d){
      return d.toLocaleDateString('fr-CH', { weekday:'long', year:'numeric', month:'long', day:'numeric' });
    }
    function computeDayIndex(){
      const start = new Date(START_DATE + "T00:00:00");
      const now = new Date();
      const diff = Math.floor((now - start)/(1000*60*60*24));
      return diff >= 0 ? (diff % Math.max(AVAILABLE_DAYS,1)) + 1 : 1;
    }
    async function fetchJSON(url){
      const res = await fetch(url);
      if(!res.ok) throw new Error('HTTP ' + res.status);
      return await res.json();
    }
    function renderTopics(topics){
      contentEl.innerHTML = '';
      topics.forEach((t, idx) => {
        const card = document.createElement('article');
        card.className = 'card';
        card.innerHTML = \`
          <div class="cat">\${t.category ?? 'Sujet'}</div>
          <div class="title">\${t.title}</div>
          <p class="muted">\${t.summary}</p>
          \${t.points && t.points.length ? '<ul class="points">' + t.points.map(p => '<li>'+p+'</li>').join('') + '</ul>' : ''}
          <div class="hint small">Question li√©e au quiz n¬∞\${idx+1}</div>
        \`;
        contentEl.appendChild(card);
      });
      topicsCount.textContent = topics.length + " sujets";
    }
    function renderQuiz(topics, day){
      quizForm.innerHTML = '';
      topics.forEach((t, i) => {
        const qid = "q_" + i;
        const block = document.createElement('div');
        block.className = 'q';
        block.innerHTML = \`
          <h4>Q\${i+1}. \${t.quiz.question}</h4>
          <div class="choices">
            \${t.quiz.choices.map((c, j) => \`
              <label><input type="radio" name="\${qid}" value="\${j}"> \${c}</label>
            \`).join('')}
          </div>
        \`;
        quizForm.appendChild(block);
      });
      document.getElementById('submitQuiz').onclick = () => {
        let correct = 0;
        const results = [];
        topics.forEach((t, i) => {
          const qid = "q_" + i;
          const selected = (new FormData(quizForm)).getAll(qid);
          const val = selected.length ? parseInt(selected[0],10) : -1;
          const ok = val === t.quiz.answer;
          if(ok) correct += 1;
          results.push({ ok, val, answer: t.quiz.answer, explanation: t.quiz.explanation, topic: t.title });
        });
        const pct = Math.round((correct / topics.length) * 100);
        scoreBox.style.display = 'block';
        scoreBox.innerHTML = \`
          <div><strong>Score :</strong> \${correct} / \${topics.length} ‚Äî \${pct}%</div>
          <div class="divider" style="margin:10px 0;"></div>
          \${results.map((r, idx) => \`
            <div class="small" style="margin-bottom:8px;">
              <span class="badge" style="border-color:\${r.ok?'#14532d':'#3f1d1d'}; background:\${r.ok?'#062b1e':'#220c0c'};">
                Q\${idx+1} \${r.ok ? '‚úÖ' : '‚ùå'}
              </span>
              <span> <em>\${r.topic}</em> ‚Äî \${r.ok ? 'Bravo !' : 'R√©ponse correcte : ' + tChoice(topics[idx].quiz.choices, topics[idx].quiz.answer)}</span>
              <div class="muted">\${r.explanation}</div>
            </div>
          \`).join('')}
        \`;
        try {
          const key = 'cq_score_day_' + day;
          localStorage.setItem(key, JSON.stringify({ correct, total: topics.length, pct, ts: Date.now() }));
        } catch(e){}
      };
    }
    function tChoice(choices, idx){ return choices[idx] ?? ''; }
    async function loadDay(day){
      const url = 'content/day' + pad(day) + '.json';
      let data;
      try {
        data = await fetchJSON(url);
      } catch (e){
        data = await fetchJSON('content/day001.json');
        day = 1;
      }
      dayLabel.textContent = "Jour " + day;
      heroTitle.textContent = data.meta?.title ?? "S√©lection du jour";
      todaySpan.textContent = formatDate(new Date());
      renderTopics(data.topics);
      renderQuiz(data.topics, day);
      const u = new URL(window.location);
      u.searchParams.set('day', String(day));
      shareLink.href = u.toString();
    }
    document.getElementById('startQuiz').onclick = () => {
      quizEl.style.display = 'block';
      document.getElementById('content').scrollIntoView({ behavior: 'smooth', block: 'start' });
    };
    document.getElementById('toggleContent').onclick = () => {
      contentEl.style.display = (contentEl.style.display === 'none') ? 'grid' : 'none';
    };
    (async () => {
      const params = new URLSearchParams(window.location.search);
      const paramDay = parseInt(params.get('day') || '0', 10);
      const day = Number.isFinite(paramDay) && paramDay > 0 ? paramDay : computeDayIndex();
      await loadDay(day);
      todaySpan.textContent = formatDate(new Date());
    })();
  </script>
</body>
</html>
